<!doctype html public "-//W3C//DTD HTML 4.0 Frameset//EN""http://www.w3.org/TR/REC-html40/frameset.dtd">
<html>
<head>
<title>
Jala 1.0 Overview
</title>
<link rel ="stylesheet" type="text/css" href="stylesheet.css" title="Style">
<script>
function asd() {
	
		parent.document.title="ListRenderer.js Overview";
	
}
</script>
</head>
<body bgcolor="white" onload="asd();">

<!-- ========== START OF NAVBAR ========== -->
<a name="navbar_top"><!-- --></a>
<table border="0" width="100%" cellpadding="1" cellspacing="0">
<tr>
<td colspan=2 bgcolor="#EEEEFF" class="NavBarCell1">
<a name="navbar_top_firstrow"><!-- --></a>
<table border="0" cellpadding="0" cellspacing="3">
  <tr align="center" valign="top">
  
  
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-summary.html"><font class="NavBarFont1"><b>Overview</b></font></a>&nbsp;</td>
  <td bgcolor="#FFFFFF" class="NavBarCell1Rev">	&nbsp;<font class="NavBarFont1Rev"><b>File</b></font>&nbsp;</td>
  

  <td bgcolor="#FFFFFF" class="NavBarCell1"> 	<font class="NavBarFont1">Class</font>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-tree.html"><font class="NavBarFont1"><b>Tree</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="index-all.html"--><font class="NavBarFont1"><b>Index</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="help-doc.html"><font class="NavBarFont1"><b>Help</b></font></a>&nbsp;</td>
  </tr>
</table>
</td>
<td bgcolor="#EEEEFF" align="right" valign="top">
<em>
<b>Jala 1.0</b></em>
</td>
</tr>

<tr>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
&nbsp;PREV&nbsp;
&nbsp;NEXT</font></td>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
  <a href="index.html" target="_top"><b>FRAMES</b></a>  &nbsp;
&nbsp;<a href="overview-summary.html" target="_top"><b>NO FRAMES</b></a>
&nbsp;&nbsp;
<script>
  <!--
  if(window==top) {
    document.writeln('<A HREF="allclasses-noframe.html" TARGET=""><B>All Classes</B></A>');
  }
  //-->
</script>
<noscript>
<a href="allclasses-noframe.html" target=""><b>All Classes</b></a>
</noscript>
</font></td>
</tr>
</table>
<!-- =========== END OF NAVBAR =========== -->

<hr>
<center>
	
	   <h2>ListRenderer.js</h2>
	
</center>

	


<h4>Summary</h4>
<p>
	
		Fields and methods of the jala.ListRenderer class.<BR/><BR/>
	
</p>

<hr>


    <table border="1" cellpadding="3" cellspacing="0" width="100%">
    <tr bgcolor="#CCCCFF" class="TableHeadingColor">
    <td colspan=2><font size="+2">
    
        <b>Class Summary</b>
    
    </font></td>
    </tr>
    
    <tr bgcolor="white" class="TableRowColor">
    <td width="15%"><b><a href="jala.ListRenderer.html">jala.ListRenderer</a></b></td>
    <td>This class eases the rendering of arbitrary lists.</td>
    </tr>
    
    <tr bgcolor="white" class="TableRowColor">
    <td width="15%"><b><a href="jala.ListRenderer.ArrayList.html">jala.ListRenderer.ArrayList</a></b></td>
    <td>A simple wrapper around an array to use in conjunction
 with jala.ListRenderer.</td>
    </tr>
    
    </table>
    <hr/> 


<!-- ========== METHOD SUMMARY =========== -->

<!-- ========== END METHOD SUMMARY =========== -->


        <pre class="sourceview"><span class="comment">//</span>
<span class="comment">// Jala Project [http://opensvn.csie.org/traccgi/jala]</span>
<span class="comment">//</span>
<span class="comment">// Copyright 2004 ORF Online und Teletext GmbH</span>
<span class="comment">//</span>
<span class="comment">// Licensed under the Apache License, Version 2.0 (the ``License'');</span>
<span class="comment">// you may not use this file except in compliance with the License.</span>
<span class="comment">// You may obtain a copy of the License at</span>
<span class="comment">//</span>
<span class="comment">//    http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="comment">//</span>
<span class="comment">// Unless required by applicable law or agreed to in writing, software</span>
<span class="comment">// distributed under the License is distributed on an ``AS IS'' BASIS,</span>
<span class="comment">// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="comment">// See the License for the specific language governing permissions and</span>
<span class="comment">// limitations under the License.</span>
<span class="comment">//</span>
<span class="comment">// $Revision$</span>
<span class="comment">// $LastChangedBy$</span>
<span class="comment">// $LastChangedDate$</span>
<span class="comment">// $HeadURL$</span>
<span class="comment">//</span>


<span class="comment">/**
 * <span class="attrib">@fileoverview</span> Fields and methods of the jala.ListRenderer class.
 */</span>


<span class="comment">// Define the global namespace for Jala modules</span>
<span class="reserved">if</span> (!global.jala) {
   global.jala = {};
}


<span class="comment">/**
 * HelmaLib dependencies
 */</span>
app.addRepository(<span class="literal">"modules/helma/Html.js"</span>);

<span class="comment">/**
 * Construct a list renderer.
 * <span class="attrib">@class</span> This class eases the rendering of arbitrary lists.
 * Such lists can be represented by HopObject collections or 
 * Arrays of HopObjects. Various arguments provide customization
 * of the number of items per page, the maximum of pages and so on.
 * <span class="attrib">@param</span> {Object} listParam Customization parameters:
 * &lt;ul&gt;
 * &lt;li&gt;collection - Collection or Array of HopObjects.&lt;/li&gt;
 * &lt;li&gt;currentPage - Optional index of the current page 
 * (&lt;code&gt;req.data.page&lt;/code&gt;)&lt;/li&gt;
 * &lt;li&gt;itemsPerPage - The optional number of items per list page.&lt;/li&gt;
 * &lt;li&gt;maxPages - The optional maximum number of pages.&lt;/li&gt;
 * &lt;li&gt;href - An optional URL string to link to.&lt;/li&gt;
 * &lt;li&gt;urlParams - Optional extra URL parameters.&lt;/li&gt;
 * &lt;/ul&gt;
 * <span class="attrib">@param</span> {Object} renderers The list types and renderer methods 
 * used to render the single items in a list.
 * <span class="attrib">@returns</span> A new list renderer instance.       
 * <span class="attrib">@throws</span> Exception if an ArrayList containing a subset of a bigger 
 * Array and has too view elements for one page or the last page.       
 * <span class="attrib">@constructor</span>
 */</span>
jala.ListRenderer = <span class="reserved">function</span>(listParam, renderers) {
   var collectionSize;
   var collection;
   var currentPage;
   var itemsPerPage;
   var maxPages;
   var totalPages;
   var href;
   var urlParams;
   var urlParamName;
   var listItemSkin;

   var cache = {
      pageNavigation: null,
      prevLink: null,
      nextLink: null
   };

   var setTotalPages = <span class="reserved">function</span>() {
      <span class="reserved">if</span> (maxPages)
         totalPages = Math.min(maxPages, Math.ceil(collectionSize / itemsPerPage));
      <span class="reserved">else</span>
         totalPages = Math.ceil(collectionSize / itemsPerPage);
      <span class="reserved">return</span>;
   };

   var getRenderFunction = <span class="reserved">function</span>(handlerName, fName) {
      <span class="reserved">if</span> (!fName)
         fName = <span class="literal">"default"</span>;
      var handler;
      <span class="reserved">if</span> (renderers != null &amp;&amp; (handler = renderers[handlerName]) != null) {
         <span class="reserved">if</span> (handler[fName] instanceof Function) {
            <span class="reserved">return</span> handler[fName];
         }
      }
      <span class="comment">// no renderer found, try to find a default renderer</span>
      <span class="reserved">if</span> ((handler = jala.ListRenderer.defaultRenderer[handlerName]) != null) {
         <span class="reserved">return</span> handler[fName];
      }
      <span class="reserved">return</span> null;
   };

   var getHref = <span class="reserved">function</span>(page) {
      <span class="reserved">if</span> (urlParams) {
         <span class="reserved">if</span> (page)
            <span class="reserved">return</span> String.compose(href, <span class="literal">"?"</span>, urlParams, <span class="literal">"&amp;"</span>, urlParamName, <span class="literal">"="</span>, page);
         <span class="reserved">else</span>
            <span class="reserved">return</span> String.compose(href, <span class="literal">"?"</span>, urlParams);
      } <span class="reserved">else</span> {
         <span class="reserved">if</span> (page)
            <span class="reserved">return</span> String.compose(href, <span class="literal">"?"</span>, urlParamName, <span class="literal">"="</span>, page);
         <span class="reserved">else</span>
            <span class="reserved">return</span> href;
      }
   };

   <span class="comment">/**
    * Returns true if this ListRenderer instance
    * has already a listItemSkin set.
    */</span>
   <span class="reserved">this</span>.hasListItemSkin = <span class="reserved">function</span>() {
      <span class="reserved">return</span> listItemSkin != null;
   };
   
   <span class="comment">/**
    * Set the amount of items shown per page.
    * <span class="attrib">@param</span> {int} limit The maximum number of items per page.
    */</span>
   <span class="reserved">this</span>.setPageSize = <span class="reserved">function</span>(limit) {
      <span class="reserved">if</span> (collectionSize == 0)
         <span class="reserved">return</span>;
      <span class="reserved">if</span> (limit &amp;&amp; !isNaN(limit)) {
         <span class="comment">// got a different itemsPerPage count, so recalculate</span>
         itemsPerPage = parseInt(limit, 10);
         setTotalPages();
      }
      <span class="comment">// correct currentPage if necessary</span>
      currentPage = Math.min(Math.max(1, currentPage), totalPages);
      <span class="reserved">return</span>;
   };
   
   <span class="comment">/**
    * Set the current Page.
    * <span class="attrib">@param</span> (int) the current Page
    */</span>
   <span class="reserved">this</span>.setCurrentPage = <span class="reserved">function</span> (page) {
      currentPage = page;
   };
   
   <span class="comment">/**
    * Returns the current Page.
    * <span class="attrib">@returns</span> the current Page.
    */</span>
   <span class="reserved">this</span>.getCurrentPage = <span class="reserved">function</span> () {
      <span class="reserved">return</span> currentPage;
   };
   
   <span class="reserved">this</span>.getSize = <span class="reserved">function</span> () {
      <span class="reserved">return</span> collectionSize;
   };

   <span class="comment">/**
    * Render the list.
    * <span class="attrib">@param</span> {Object} param Object containing
    * extra parameters (e.g. from a Hop macro call).
    */</span>
   <span class="reserved">this</span>.renderList = <span class="reserved">function</span>(param) {
      <span class="reserved">if</span> (collectionSize == 0 || totalPages == 0)
         <span class="reserved">return</span> null;
      var idx, stop;
      <span class="reserved">this</span>.setPageSize();
      <span class="reserved">if</span> (itemsPerPage) {
         idx = ((currentPage -1) * itemsPerPage);
         stop = Math.min(idx + itemsPerPage, collectionSize);
      } <span class="reserved">else</span> {
         idx = 0;
         stop = collectionSize;
         itemsPerPage = stop;
      }
      <span class="comment">// preload objects if collection is a HopObject one</span>
      <span class="reserved">if</span> (collection instanceof HopObject) {
         collection.prefetchChildren(idx, stop - idx);
      }

      var prevItem = null;
      <span class="reserved">if</span> (!param)
         var param = {};
      var renderFunc = getRenderFunction(<span class="literal">"list"</span>, param.type);
      param.counter = 1;
      param.index = idx + 1;
      param.stop = stop;
      param.itemsPerPage = itemsPerPage;
      param.collectionSize = collectionSize;
      <span class="reserved">if</span> (!param.skin &amp;&amp; listItemSkin)
         param.skin = listItemSkin;
      <span class="reserved">while</span> (idx &lt; stop) {
         var item = collection.get(idx++);
         renderFunc(item, prevItem, param);
         prevItem = item;
         param.counter += 1;
         param.index += 1;
      }
      <span class="reserved">return</span>;
   };

   <span class="comment">/**
    * Render the list as string.
    * <span class="attrib">@param</span> {Object} param Object containing
    * extra parameters (e.g. from a Hop macro call).
    * <span class="attrib">@returns</span> The rendered list.
    * <span class="attrib">@type</span> String
    * <span class="attrib">@see</span> jala.ListRenderer#renderList
    */</span>
   <span class="reserved">this</span>.renderListAsString = <span class="reserved">function</span>(param) {
      res.push();
      <span class="reserved">this</span>.renderList(param);
      <span class="reserved">return</span> res.pop();
   };

   <span class="comment">/**
    * Render a link to the previous page as string.
    * <span class="attrib">@param</span> {Object} param Object containing
    * extra parameters (e.g. from a Hop macro call).
    * <span class="attrib">@returns</span> The rendered link to the previous page.
    * <span class="attrib">@type</span> String
    */</span>
   <span class="reserved">this</span>.renderPrevLinkAsString = <span class="reserved">function</span>(param) {
      <span class="reserved">if</span> (collectionSize == 0 || currentPage &lt;= 1)
         <span class="reserved">return</span> null;
      <span class="reserved">if</span> (!cache.prevLink) {
         res.push();
         param.index = currentPage -1;
         param.href = getHref(param.index);
         var renderFunc = getRenderFunction(<span class="literal">"pageLink"</span>, param.type);
         <span class="reserved">if</span> (!renderFunc)
            <span class="reserved">return</span> <span class="literal">"[render function missing]"</span>;
         renderFunc(<span class="literal">"prev"</span>, param);
         cache.prevLink = res.pop();
      }
      <span class="reserved">return</span> cache.prevLink;
   };

   <span class="comment">/**
    * Render a link to the previous page.
    * <span class="attrib">@param</span> {Object} param Object containing
    * extra parameters (e.g. from a Hop macro call).
    * <span class="attrib">@see</span> jala.ListRenderer#renderPrevLink
    */</span>
   <span class="reserved">this</span>.renderPrevLink = <span class="reserved">function</span>(param) {
      res.write(<span class="reserved">this</span>.renderPrevLinkAsString(param));
      <span class="reserved">return</span>;
   };

   <span class="comment">/**
    * Render a link to the next page as string.
    * <span class="attrib">@param</span> {Object} param Object containing
    * extra parameters (e.g. from a Hop macro call).
    * <span class="attrib">@returns</span> The rendered link to the next page.
    * <span class="attrib">@type</span> String
    */</span>
   <span class="reserved">this</span>.renderNextLinkAsString = <span class="reserved">function</span>(param) {
      <span class="reserved">if</span> (collectionSize == 0 || currentPage &gt;= totalPages)
         <span class="reserved">return</span> null;
      <span class="reserved">if</span> (!cache.nextLink) {
         res.push();
         param.index = currentPage +1;
         param.href = getHref(param.index);
         var renderFunc = getRenderFunction(<span class="literal">"pageLink"</span>, param.type);
         <span class="reserved">if</span> (!renderFunc)
            <span class="reserved">return</span> <span class="literal">"[render function missing]"</span>;
         renderFunc(<span class="literal">"next"</span>, param);
         cache.nextLink = res.pop();
      }
      <span class="reserved">return</span> cache.nextLink;
   };

   <span class="comment">/**
    * Render a link to the next page.
    * <span class="attrib">@param</span> {Object} param Object containing
    * extra parameters (e.g. from a Hop macro call).
    * <span class="attrib">@see</span> jala.ListRenderer#renderNextLink
    */</span>
   <span class="reserved">this</span>.renderNextLink = <span class="reserved">function</span>(param) {
      res.write(<span class="reserved">this</span>.renderNextLinkAsString(param));
      <span class="reserved">return</span>;
   };

   <span class="comment">/**
    * Render a page navigation bar.
    * <span class="attrib">@param</span> {Object} param Object containing
    * extra parameters (e.g. from a Hop macro call).
    * <span class="attrib">@see</span> jala.ListRenderer#renderPageNavigationAsString
    */</span>
   <span class="reserved">this</span>.renderPageNavigation = <span class="reserved">function</span>(param) {
      res.write(<span class="reserved">this</span>.renderPageNavigationAsString(param));
      <span class="reserved">return</span>;
   };

   <span class="comment">/**
    * Render a page navigation bar as string.
    * <span class="attrib">@param</span> {Object} param Object containing
    * extra parameters (e.g. from a Hop macro call).
    * <span class="attrib">@returns</span> The rendered page navigation bar.
    * <span class="attrib">@type</span> String
    */</span>
   <span class="reserved">this</span>.renderPageNavigationAsString = <span class="reserved">function</span>(param) {
      <span class="comment">/**
       * Private method for rendering a single navigation item
       */</span>
      var renderItem = <span class="reserved">function</span>(text, currPage, selected) {
         renderFunc(<span class="literal">"item"</span>, {text: text,
                             url: getHref(currPage),
                             selected: selected});
         <span class="reserved">return</span>;
      };

      <span class="reserved">if</span> (collectionSize == 0 || totalPages &lt;= 1)
         <span class="reserved">return</span> null;
      <span class="reserved">if</span> (!cache.pageNavigation) {
         var renderFunc = getRenderFunction(<span class="literal">"pageNavigation"</span>, param.type);
         <span class="reserved">if</span> (!renderFunc)
            <span class="reserved">return</span> <span class="literal">"[Render function missing]"</span>;

         var navLength = parseInt(param.length, 10) || 10;
         <span class="comment">// correct currentPage if necessary</span>
         <span class="reserved">this</span>.setPageSize();
         var navParam = {
            from: ((currentPage -1) * itemsPerPage) +1,
            to: Math.min(((currentPage -1) * itemsPerPage) + itemsPerPage, collectionSize),
            total: collectionSize
         }
      
         <span class="comment">// render the navigation-bar</span>
         res.push();
         <span class="reserved">if</span> (currentPage &gt; 1)
            renderItem((param.previous || <span class="literal">"prev"</span>), currentPage -1);
         var pageNr = 1 + Math.floor((currentPage -1) / navLength) * navLength;
         <span class="reserved">if</span> (pageNr &gt; 1)
            renderItem((param.previousN || <span class="literal">"[..]"</span>), pageNr - navLength);
         var stop = Math.min(pageNr + navLength, totalPages +1);
      
         <span class="reserved">while</span> (pageNr &lt; stop) {
            renderItem((param.itemPrefix || <span class="literal">""</span>) + pageNr + (param.itemSuffix || <span class="literal">""</span>),
                       pageNr,
                       pageNr == currentPage);
            pageNr++;
         }
         <span class="reserved">if</span> (pageNr &lt; totalPages)
            renderItem((param.nextN || <span class="literal">"[..]"</span>), pageNr);
         <span class="reserved">if</span> (currentPage &lt; totalPages)
            renderItem((param.next || <span class="literal">"next"</span>), (currentPage +1));
         navParam.pageNavigation = res.pop();
         res.push();
         renderFunc(<span class="literal">"navigation"</span>, navParam);
         cache.pageNavigation = res.pop();
      }
      <span class="reserved">return</span> cache.pageNavigation;
   };

   <span class="comment">// object initialization</span>
   <span class="comment">// FIXME: this is for backwards compatibility only</span>
   <span class="reserved">if</span> (listParam.collection instanceof Array) {
      collection = new jala.ListRenderer.ArrayList(listParam.collection);
   } <span class="reserved">else</span> {
      collection = listParam.collection;
   }
   
   collectionSize = collection.size();
   href = listParam.href || <span class="literal">""</span>;
   urlParams = listParam.urlParams;
   urlParamName = listParam.urlParamName || <span class="literal">"page"</span>;
   currentPage = (!listParam.currentPage || isNaN(listParam.currentPage)) ? 1 : parseInt(listParam.currentPage, 10);
   itemsPerPage = !listParam.itemsPerPage ? collectionSize : parseInt(listParam.itemsPerPage, 10);
   maxPages = listParam.maxPages;
   listItemSkin = listParam.itemSkin;
   <span class="comment">// calculate the number of pages</span>
   setTotalPages();

   <span class="reserved">return</span> <span class="reserved">this</span>;
};

<span class="comment">/**
 * Static instance of helma.Html
 * <span class="attrib">@type</span> helma.Html
 */</span>
jala.ListRenderer.html = new helma.Html();

<span class="comment">/** <span class="attrib">@ignore</span> */</span>
jala.ListRenderer.<span class="reserved">prototype</span>.toString = <span class="reserved">function</span>() {
   <span class="reserved">return</span> <span class="literal">"[jala.ListRenderer]"</span>;
};



<span class="comment">/*********************************
 ********** M A C R O S **********
 *********************************/</span>


<span class="comment">/**
 * Render the maximum number of items per page.
 * <span class="attrib">@param</span> {Object} param Extra Hop macro parameters:
 * &lt;ul&gt;
 * &lt;li&gt;to - The maximum number of items per page to be set.
 * &lt;/ul&gt;
 */</span>
jala.ListRenderer.<span class="reserved">prototype</span>.limit_macro = <span class="reserved">function</span>(param) {
   <span class="reserved">if</span> (param.to)
      <span class="reserved">this</span>.setPageSize(param.to);
   <span class="comment">// FIXME: we should implement this:</span>
   <span class="comment">//else</span>
   <span class="comment">//   res.write(this.getPageSize());</span>
   <span class="reserved">return</span>;
};


<span class="comment">/**
 * Render the link to the previous page.
 * <span class="attrib">@param</span> {Object} param Extra Hop macro parameters:
 * &lt;ul&gt;
 * &lt;li&gt;type - The type of renderer to be applied.&lt;/li&gt;
 * &lt;/ul&gt;
 * <span class="attrib">@see</span> jala.ListRenderer#renderPrevLink
 */</span>
jala.ListRenderer.<span class="reserved">prototype</span>.prevLink_macro = <span class="reserved">function</span>(param) {
   <span class="reserved">this</span>.renderPrevLink(param);
   <span class="reserved">return</span>;
};

<span class="comment">/**
 * Render the link to the next page.
 * <span class="attrib">@param</span> {Object} param Extra Hop macro parameters:
 * &lt;ul&gt;
 * &lt;li&gt;type - The type of renderer to be applied.&lt;/li&gt;
 * &lt;/ul&gt;
 * <span class="attrib">@see</span> jala.ListRenderer#renderNextLink
 */</span>
jala.ListRenderer.<span class="reserved">prototype</span>.nextLink_macro = <span class="reserved">function</span>(param) {
   <span class="reserved">this</span>.renderNextLink(param);
   <span class="reserved">return</span>;
};


<span class="comment">/**
 * Render the page navigation bar.
 * <span class="attrib">@param</span> {Object} param Extra Hop macro parameters:
 * &lt;ul&gt;
 * &lt;li&gt;type - The type of renderer to be applied.&lt;/li&gt;
 * &lt;/ul&gt;
 * <span class="attrib">@see</span> jala.ListRenderer#renderPageNavigationAsString
 */</span>
jala.ListRenderer.<span class="reserved">prototype</span>.pageNavigation_macro = <span class="reserved">function</span>(param) {
   <span class="reserved">this</span>.renderPageNavigation(param);
   <span class="reserved">return</span>;
};

<span class="comment">/**
 * Return the current page
 */</span>
jala.ListRenderer.<span class="reserved">prototype</span>.currentPage_macro = <span class="reserved">function</span> (param) {
   <span class="reserved">return</span> <span class="reserved">this</span>.getCurrentPage();
}

<span class="comment">/**
 * Return the total number of items
 */</span>
jala.ListRenderer.<span class="reserved">prototype</span>.size_macro = <span class="reserved">function</span> (param) {
   <span class="reserved">return</span> <span class="reserved">this</span>.getSize();
}

<span class="comment">/**
 * Render the list.
 * <span class="attrib">@param</span> {Object} param Extra Hop macro parameters:
 * &lt;ul&gt;
 * &lt;li&gt;skin - The name of the main list skin.&lt;/li&gt;
 * &lt;li&gt;type - The type of renderer to be applied.&lt;/li&gt;
 * &lt;/ul&gt;
 * <span class="attrib">@see</span> jala.ListRenderer#renderList
 */</span>
jala.ListRenderer.<span class="reserved">prototype</span>.render_macro = <span class="reserved">function</span>(param) {
   <span class="reserved">if</span> (!param.skin &amp;&amp; !<span class="reserved">this</span>.hasListItemSkin())
      <span class="reserved">return</span> <span class="literal">"[Name of skin missing]"</span>;
   <span class="reserved">this</span>.renderList(param);
   <span class="reserved">return</span>;
};



<span class="comment">/*****************************************************
 ********** D E F A U L T   R E N D E R E R **********
 *****************************************************/</span>


<span class="comment">/**
 * Default Renderer object containing functions
 * used for rendering different list items (eg. page navigation,
 * prev/next links and list items).
 * <span class="attrib">@final</span>
 */</span>
jala.ListRenderer.defaultRenderer = {
   <span class="comment">/**
    * List renderer object
    */</span>
   list: {
      <span class="comment">/**
       * Default renderer method for a list
       * <span class="attrib">@param</span> {Object} item The current list item to render.
       * <span class="attrib">@param</span> {Object} prevItem The previous list item
       * <span class="attrib">@param</span> {Object} param A parameter object containing macro attributes
       * and some parameters set by the ListRenderer.
       */</span>
      <span class="literal">"default"</span>: <span class="reserved">function</span>(item, prevItem, param) {
         var p = {<span class="literal">"class"</span>: (param.index % 2 == 0 ? <span class="literal">"even"</span> : <span class="literal">"odd"</span>)};
         item.renderSkin(param.skin, p);
         <span class="reserved">return</span>;
      }
   },

   <span class="comment">/**
    * Pagenavigation renderer object
    */</span>
   pageNavigation: {
      <span class="comment">/**
       * Default renderer method for a pagenavigation bar.
       * <span class="attrib">@param</span> {String} what A string indicating what should be rendered. Can be
       * either "item" or "navigation" (the former is a single page link, the latter
       * is the whole navigation.
       * <span class="attrib">@param</span> {Object} A parameter object containing the macro attributes and some
       * attributes set by the ListRenderer.
       */</span>
      <span class="literal">"default"</span>: <span class="reserved">function</span>(what, param) {
         var skin;
         switch (what) {
            case <span class="literal">"item"</span>:
               <span class="reserved">if</span> (param.selected == true) {
                  param[<span class="literal">"class"</span>] = <span class="literal">"selected"</span>;
               } <span class="reserved">else</span> {
                  delete param[<span class="literal">"class"</span>];
               }
               param.text = jala.ListRenderer.html.linkAsString({href: param.url}, param.text);
               <span class="reserved">if</span> (param.skin != null) {
                  renderSkin(param.skin, param);
               } <span class="reserved">else</span> <span class="reserved">if</span> ((skin = app.getSkin(<span class="literal">"Global"</span>, <span class="literal">"pageNavigationItem"</span>, res.skinpath)) != null) {
                  renderSkin(skin, param);
               } <span class="reserved">else</span> {
                  <span class="reserved">if</span> (param[<span class="literal">"class"</span>]) {
                     res.write(<span class="literal">'&lt;span class="'</span> + param[<span class="literal">"class"</span>] + <span class="literal">'"&gt;['</span>);
                  } <span class="reserved">else</span> {
                     res.write(<span class="literal">"&lt;span&gt;["</span>);
                  }
                  res.write(param.text);
                  res.write(<span class="literal">']&lt;/span&gt;'</span>);
               }
               break;

            case <span class="literal">"navigation"</span>:
               <span class="reserved">if</span> (param.skin != null) {
                  renderSkin(param.skin, param);
               } <span class="reserved">else</span> <span class="reserved">if</span> ((skin = app.getSkin(<span class="literal">"Global"</span>, <span class="literal">"pageNavigation"</span>, res.skinpath)) != null) {
                  renderSkin(skin, param);
               } <span class="reserved">else</span> {
                  res.write(<span class="literal">'&lt;div class="pageNavigation"&gt;'</span>);
                  res.write(<span class="literal">'&lt;span class="summary"&gt;displaying '</span>);
                  res.write(param.from);
                  res.write(<span class="literal">"-"</span>);
                  res.write(param.to);
                  res.write(<span class="literal">" (of "</span>);
                  res.write(param.total);
                  res.write(<span class="literal">")&lt;/span&gt;"</span>);
                  res.write(<span class="literal">'&lt;span class="pages"&gt;'</span>);
                  res.write(param.pageNavigation);
                  res.write(<span class="literal">"&lt;/span&gt;&lt;/div&gt;"</span>);
               }
               break;
         }
         <span class="reserved">return</span>;
      }
   },

   <span class="comment">/**
    * Pagelink renderer object
    */</span>
   pageLink: {
      <span class="comment">/**
       * Default rendering method for a page link (aka "prev/next" link)
       * <span class="attrib">@param</span> {String} what A string indicating what should be rendered. Can be
       * either "prev" or "next"
       * <span class="attrib">@param</span> {Object} param A parameter object containing macro attributes and
       * some set by the ListRenderer.
       */</span>
      <span class="literal">"default"</span>: <span class="reserved">function</span>(what, param) {
         delete param.index;
         <span class="reserved">if</span> (param.skin) {
            renderSkin(param.skin, param);
         } <span class="reserved">else</span> {
            jala.ListRenderer.html.link(param, param.text || what);
         }
         <span class="reserved">return</span>;
      }
   }
};



<span class="comment">/*****************************************************
 ********** D E F A U L T   R E N D E R E R **********
 *****************************************************/</span>



<span class="comment">/**
 * Creates a new ArrayList instance.
 * <span class="attrib">@class</span> A simple wrapper around an array to use in conjunction
 * with jala.ListRenderer. This wrapper can either handle complete arrays
 * or subsections of an array. In the latter case the wrapper needs offset
 * and total size information as argument to mimick a complete array.
 * <span class="attrib">@param</span> {Array} arr The array (or a subsection of an array) to wrap
 * <span class="attrib">@param</span> {Number} offset An optional offset to use (mandatory if the array
 * is just a subsection).
 * <span class="attrib">@param</span> {Number} total An optional total size of the array. This argument is mandatory
 * if the wrapped array is just a subsection.
 * <span class="attrib">@returns</span> A newly created ArrayList instance
 * <span class="attrib">@constructor</span>
 */</span>
jala.ListRenderer.ArrayList = <span class="reserved">function</span>(arr, offset, total) {
   <span class="reserved">this</span>.offset = offset || 0;
   <span class="reserved">this</span>.length = total || arr.length;
   
   var isArraySubset = offset || total ? true : false;

   <span class="comment">/**
    * Returns the element at the index position passed
    * as argument. If the wrapped array is just a subsection
    * the index position passed will be corrected using
    * the offset.
    * <span class="attrib">@param</span> {Number} idx The index position of the element
    * to return
    * <span class="attrib">@returns</span> The element at the given index position
    */</span>
   <span class="reserved">this</span>.get = <span class="reserved">function</span>(idx) {
      <span class="reserved">return</span> arr[(<span class="reserved">this</span>.offset &gt; 0) ? idx - offset : idx];
   };

   <span class="comment">/**
    * Returns the size of this ArrayList, which is either
    * the length of the wrapped array or the total size
    * passed as argument to the constructor (in case the wrapped
    * array is just a subsection).
    * <span class="attrib">@returns</span> The size of this ArrayList instance
    * <span class="attrib">@type</span> Number
    */</span>
   <span class="reserved">this</span>.size = <span class="reserved">function</span>() {
      <span class="reserved">return</span> <span class="reserved">this</span>.length;
   };
   
   <span class="comment">/**
    * Returns true if this ArrayList is a subsection of a bigger array
    * <span class="attrib">@returns</span> true or false. true if this ArrayList is a subsection of a bigger array
    */</span>
   <span class="reserved">this</span>.isSubset = <span class="reserved">function</span>() {
      <span class="reserved">return</span> isArraySubset;
   }
   
   <span class="comment">/**
    * Returns the actual size of this ArrayList's wrapped array.
    * <span class="attrib">@returns</span> the actual size of this ArrayList's wrapped array.
    */</span>
   <span class="reserved">this</span>.subsetSize = <span class="reserved">function</span>() {
      <span class="reserved">return</span> arr.length;
   }

   <span class="reserved">return</span> <span class="reserved">this</span>;
};

<span class="comment">/** <span class="attrib">@ignore</span> */</span>
jala.ListRenderer.ArrayList.<span class="reserved">prototype</span>.toString = <span class="reserved">function</span>() {
   <span class="reserved">return</span> <span class="literal">"[jala.ListRenderer.ArrayList]"</span>;
};</pre>
	<hr>



<!-- ========== START OF NAVBAR ========== -->
<a name="navbar_top"><!-- --></a>
<table border="0" width="100%" cellpadding="1" cellspacing="0">
<tr>
<td colspan=2 bgcolor="#EEEEFF" class="NavBarCell1">
<a name="navbar_top_firstrow"><!-- --></a>
<table border="0" cellpadding="0" cellspacing="3">
  <tr align="center" valign="top">
  
  
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-summary.html"><font class="NavBarFont1"><b>Overview</b></font></a>&nbsp;</td>
  <td bgcolor="#FFFFFF" class="NavBarCell1Rev">	&nbsp;<font class="NavBarFont1Rev"><b>File</b></font>&nbsp;</td>
  

  <td bgcolor="#FFFFFF" class="NavBarCell1"> <font class="NavBarFont1">Class</font>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-tree.html"><font class="NavBarFont1"><b>Tree</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="index-all.html"--><font class="NavBarFont1"><b>Index</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="help-doc.html"><font class="NavBarFont1"><b>Help</b></font></a>&nbsp;</td>
  </tr>
</table>
</td>
<td bgcolor="#EEEEFF" align="right" valign="top"><em>
<b>Jala 1.0</b></em>
</td>
</tr>

<tr>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
&nbsp;PREV&nbsp;
&nbsp;NEXT</font></td>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
  <a href="index.html" target="_top"><b>FRAMES</b></a>  &nbsp;
&nbsp;<a href="overview-summary.html" target="_top"><b>NO FRAMES</b></a>
&nbsp;&nbsp;
<script>
  <!--
  if(window==top) {
    document.writeln('<A HREF="allclasses-noframe.html" TARGET=""><B>All Classes</B></A>');
  }
  //-->
</script>
<noscript>
<a href="allclasses-noframe.html" target=""><b>All Classes</b></a>
</noscript>
</font></td>
</tr>
</table>
<!-- =========== END OF NAVBAR =========== -->

<hr>
<font size="-1">

</font>
<div class="jsdoc_ctime">Documentation generated by <a href="http://jsdoc.sourceforge.net/" target="_parent">JSDoc</a> on Thu Mar 15 15:28:10 2007</div>
</body>
</html>
